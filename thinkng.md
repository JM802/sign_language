### 一 、初始维数怎么计算的(134维)

1. MediaPipe Holistic 模型标准的 Pose 检测包含 33 个关键点。
2. 但是本项目主要做的手语（上半身），0-24点包含全部上半身
3. mp标准输出左右手分别21个点
4. x,y计算逻辑：mp提供了深度z信息，但是手语一般仅需要2维，即x，y坐标，降低模型复杂度，便于训练

### 二、视频预处理流程（extract_features）

1. 通过start_frame,end_frame指定帧区间
2. 通过for循环限制0-25，只选取pose的上半身，其余选择左右手全部21点，未识别到的用（0，0）填充
3. 选取动态视频模式，**基于视频的帧间关联性**来跟踪关键点
4. lm_x,lm_y指相对画面（归一化）的坐标，避免因为画面大小不同导致识别错误

### 三、参数的标准化(Z-score标准化)

1. 通过正态分布公式对每一列即每一个手语特征做标准化，解决不同数值取值范围不同的问题，防止比如模型对坐标分配过多注意力而忽略速度参数

### 四、原始json数据流转

1. json格式：{"video_001": {"subset":"train", "action":[0,10,50]}}，标明video_id,subset_name(train.val,test),label,start_frame,end_frame
2. extract_features函数处理生成video_id.npy文件，shape为有效帧*134（用for循环遍历），每一个视频对应一个npy,用video_id区分
3. 按subset类型分类，subsets[subset]存储{npy_save_path},{label}，比如上面的例子train列表里面是npy_save_path,label
4. {subset_name}_map_300.txt 这个map_file里面每一行存储npy_save_path,label,有三个train,val,test
5. 训练集归一化，测试 / 验证集也用训练集的 mean/std，避免数据泄露

### 五、双重相对坐标处理

1. mp点位图(全身+手部)![1771846348616](image/thinkng/1771846348616.png)

    ![1771846517399](image/thinkng/1771846517399.png)

pose:

| 分类         | 编号范围 | 包含核心部位           | 特征维度（x+y） |
| ------------ | -------- | ---------------------- | --------------- |
| 头部关键点   | 0-10     | 鼻子、眼睛、耳朵、嘴巴 | 11×2=22 维     |
| 上半身关键点 | 11-24    | 肩膀、手肘、手腕、髋部 | 14×2=28 维     |
| 下半身关键点 | 25-32    | 膝盖、脚踝、脚部       | 8×2=16 维      |

hands:

| 分类                        | 编号范围 | 包含核心部位               | 特征维度（x+y） |
| --------------------------- | -------- | -------------------------- | --------------- |
| 手部基准点                  | 0        | 手腕（掌根）               | 1×2=2 维       |
| 大拇指                      | 1-4      | 大拇指 4 个关节 + 指尖     | 4×2=8 维       |
| 四指（食 / 中 / 无名 / 小） | 5-20     | 4 根手指各 4 个关节 + 指尖 | 16×2=32 维     |

2. 基准点(计算相对坐标)

    pose[0]:鼻子

    hands[0]:左右手腕

3. 以nose,l_wrist,r_wrist为基准点，计算相对坐标

```
 pose_rel = pose - nose
    lh_rel = lh - l_wrist
    rh_rel = rh - r_wrist
```

### 六、速度的处理（维度扩展为268）

1. 计算后一帧-前一帧(diff)，此时T变为T-1，用坐标的差值大小作为速度
2. 第一帧补0，统一维度，，变为T
3. 将速度参数传入最终维度，134*2=268
4. 提高了对不同运动趋势的敏感度(速度特征)，能很好地区分快抬手与慢抬手
