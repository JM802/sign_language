# 后续提升方向

### 一、重建3维的手部模型，将手语画面3维化(需要重新训练一个模型)

1. **使用开源的 ExPose或 S2HAND，将 WLASL 视频输入这些 SOTA 模型，提取每一帧的  MANO 参数 （姿态 $\theta$ 和 形状 $\beta$）(我选择S2HAND,轻型模型能部署在边缘端)**
2. **MANO：**

   **① 形状参数：$\beta$ (Shape Parameters)**

   * **维度 ：通常是一个 $10$ 维的向量。**
   * **作用 ：控制手部的 固有属性 。比如手指的长短、手掌的宽窄、整体的胖瘦。**
   * **原理 ：它是通过对大量不同人的手进行 PCA 得到的。$\beta = 0$ 代表平均手型，改变数值会沿主成分方向调整形状。**

   **② 姿态参数：$\theta$ (Pose Parameters)**

   * **维度 ：$48$ 维向量。**
   * **全球旋转 (Global Rotation) ：$3$ 维（通常用轴角法表示），控制手腕在空间中的指向。**
   * **手指关节 (Joint Rotations) ：$15$ 个关键关节，每个关节 $3$ 自由度（$15 \times 3 = 45$ 维）。**
   * **作用 ：控制手部的 动作 。比如握拳、指向、打手势等。**

   **③ 姿态修正项 (Pose-Corrective Blend Shapes)**

   **虽然这不是用户直接输入的参数，但它是 MANO 的精髓。模型会根据 $\theta$ 的变化，自动计算皮肤的次级变形，防止关节处出现纸片折叠的廉价感。**
3. **MANO输出：**

   **当你给 MANO 输入了 $\beta$ 和 $\theta$ 后，它会通过线性混合蒙皮（LBS）算法输出：**

* **3D 网格 (Mesh) ：包含 $778$ 个顶点和 $1538$ 个面片。**
* **关节位置 (Joints) ：$21$ 个手部关键点的 3D 坐标。**

4. ExPose(全身表达性人体重构)：

   - 不是直接对整张图进行回归，而是先定位身体，再根据身体姿态裁剪出高分辨率的手部和面部图像。
   - 巧妙地解决了局部（手/脸）与全局（身体）的衔接问题。
   - 输出丰富 ：

     - Body : 形状与大关节动作。
     - Face : 包含面部表情（FLAME 参数)
     - Hands : 包含精细的手指动作（MANO 参数）
5. S2HAND

- 核心背景
  在野外场景（如街道、室内）获取精准的 3D 手部 Ground Truth非常困难且昂贵。
- 技术亮点
  - **自监督学习** ：它不需要海量的 3D 坐标标注，而是利用 **一致性约束**
  - **可微渲染** ：这是 S2HAND 的灵魂。
    1. 网络预测 MANO 参数（**$\beta, \theta$**）。
    2. 通过可微渲染器将 3D 手部网格投影回 2D 图像。
    3. **计算损失** ：比较投影出的手部掩码（Mask）和颜色与原图的差异
    4. **多视图/深度一致性** ：通过利用图像内部的对称性和深度信息，在没有 3D 标签的情况下也能训练出效果不错的手部模型。

### 二、具体流程

#### 第一阶段：数据预处理 (Hand Cropping)

S2HAND 属于单目手部模型，输入整张包含复杂背景的人体图像会导致精度下降。必须先把手“抠”出来。

1. **环境准备** ：在你已经配置好的 Conda 环境中，安装 MediaPipe (`pip install mediapipe`) 和 OpenCV。
2. **手部区域提取 (ROI Bounding Box)** ：

* 遍历你的 300 个词汇文件夹中的视频序列。
* 使用 MediaPipe Hands 跑一遍这些视频，并固定划分为 64 帧，获取手部所在的边界框（BBox）。
* 为了防止手部出框，将 BBox 向外扩展 1.2 - 1.5 倍，然后将图片裁剪并统一缩放到 **$224 \times 224$**

1. **异常帧剔除** ：如果某几帧 MediaPipe 没有检测到手（比如因为遮挡），用前后帧的 BBox 进行线性插值补全。

---

#### 第二阶段：伪标签生成 (16GB GPU 离线运算)

这是消耗算力的核心步骤，但 16GB 显存处理 **$224 \times 224$** 的图片绰绰有余。

1. **加载 S2HAND 与 MANO 模型** ：

* 在 PyTorch 中加载 S2HAND 预训练权重。
* 由于你是为了建立标准动作库， **强烈建议在推断时，将形状参数 **$\beta$** 强制设为 **$\mathbf{0}$**** （或者取该视频所有帧输出的平均值）。这样可以消除不同演示者胖瘦手型的差异，手机端渲染时统一使用一个“标准手”。

2. **Batch Processing** ：

* 充分利用 16GB 显存，可以把 Batch Size 设置为 64（刚好一个视频的帧数）或 128。
* 输入：**$64 \times 3 \times 224 \times 224$** 的 Tensor。
* 输出：提取姿态参数 **$\theta$**（形状为 **$64 \times 48$** 的矩阵）。

3. **时间序列平滑 (Temporal Smoothing)** ：

* 因为手语动作速度快，逐帧预测的 **$\theta$** 可能会有微小的抖动。
* 使用 `scipy.signal.savgol_filter` 对这 **$64 \times 48$** 的矩阵在时间维度上做一次平滑处理。

---

#### 第三阶段：构建 3D 动作数据库 (Indexing)

手机端不需要庞大的模型，只需要轻量级的数据文件。

1. **数据降维与清洗** ：

* 我们只需要姿态参数 **$\theta$**。这 48 维数据代表了手腕的全局旋转（3维）加上 15 个关节的旋转（45维）。

2. **序列化存储** ：

* 将这 300 个词的平滑后 **$\theta$** 矩阵保存为 JSON 格式。
* 数据结构示例：
  **JSON**

  ```
  {
    "word_id_001": {
      "word_name": "hello",
      "frames": 64,
      "theta": [[0.1, ..., -0.2], ..., [0.0, ..., 0.5]] // 64 x 48 的二维数组
    },
    ...
  }
  ```
* 这个 JSON 文件可能只有几 MB 大小，非常适合打包进 Android 的 `assets` 目录。

---

#### 第四阶段：香橙派部署

在香橙派上，你的主程序逻辑将变得非常线性且轻量。

1. **加载资源** ：

* 加载你训练好的动作识别 `.pth` 模型（如果在香橙派上推理慢，强烈建议转成 ONNX 格式，用 `onnxruntime` 跑）。
* 将刚刚生成的 `mano_database.json` 加载到内存中的 Python 字典里。

2. **获取分类结果** ：

* 摄像头实时读取手势 **$\rightarrow$** 提取特征 **$\rightarrow$** 喂给你的识别模型。
* 模型输出当前动作的类别索引（例如：预测结果为类别 `1`）。

3. **自动匹配（查表）** ：

* 直接通过类别索引 `1`，从内存字典中提取出对应的 64 帧 **$\theta$** 参数序列。
* 这就是你的“匹配”过程，时间复杂度为 **$O(1)$**。

#### 第五阶段：MANO 前向计算与 3D 渲染

这是最后也是最出效果的一步。拿到 **$\theta$** 序列后，怎么在香橙派屏幕上把它画出来？

**1. 通过 MANO Layer 计算 3D 顶点**

在香橙派上，你不需要安装庞大的 S2HAND，只需要安装一个轻量级的 `manopth`（MANO 的 PyTorch 实现）或者用 NumPy 手写一个前向传播。

* 输入：当前帧的 **$\theta$**（48 维）和固定的 **$\beta$**（10 维，全 0）。
* 计算：通过线性混合蒙皮（LBS）算法，MANO Layer 会输出 778 个 3D 顶点坐标和 1538 个面片（Faces）的拓扑关系。

**2. 轻量级 3D 渲染引擎**

香橙派的 GPU 性能有限，跑不了虚幻引擎这种重型框架。推荐使用以下两种 Python 轻量级方案：

* **方案 A：`pyrender` (推荐)**
  它是基于 OpenGL 的 Python 渲染库，非常适合离屏渲染或简单的实时弹窗。你可以将 MANO 输出的顶点和面片构建成一个 `trimesh` 对象，然后丢进 `pyrender.Viewer` 里实时更新。
* **方案 B：`pyqtgraph` 或 `Vispy`**
  如果你打算给这个系统做一个完整的 GUI 界面（比如左边显示摄像头，右边显示 3D 手语动画），`Vispy` 这种底层直接调用 OpenGL 的库能跑到 60 FPS 以上，非常丝滑。

### 三、前端

1. 增加鼓励的话语和对聋哑人心态的关心（聋哑人生活比较艰难，思想和正常人一样，但是在社会上受到一些歧视）
